# Mathematical model and state space

## Simulate the circuit in Figure 1, input `u = sin(t)` is a current source, `y` is the voltage across the capacitor, with zero initial conditions. Plot `y(t)`.

<p align="center">            
<img src="https://github.com/JoseEmmanuelVG/MechatronicSystemsControl/assets/89156254/40f7efc8-1530-44b6-988c-5bdc22fb50be" width="600" height="300">
    <br>
    <strong><em>  
Circuit simulation diagram 
    </em></strong>
</p>



## Objective

To determine the voltage `y(t)` on a capacitor C2:

### Current Source Configuration `u(t)`.

- The current source represents the input to the circuit and is modeled as a sinusoidal signal `u(t)=sen(t)`.
- **Sine Wave" block in Simulink:** Amplitude: 1 (this represents the current source).
  - Amplitude: 1 (this represents the maximum value of the current).
  - Frequency: 1 Hz (this defines the oscillation frequency of the signal).
  - Phase angle: 0 degrees (this indicates no initial phase shift).

### Simscape Electrical components

- **Resistor R1 and R2:**
  - Both resistors are set to a value of 1 Ω.
  - They are used to model the electrical resistance in the circuit.
- **Capacitors C1 and C2:** Both capacitors have a capacitance of 1 Ω.
  - Both capacitors have a capacitance of 1 F.
  - They store energy in the circuit and release the energy when needed.
- **Coil L:**  Coil L is set to a value of 1 F.
  - It is configured with a value of 1 H.
  - It represents the inductance in the circuit and opposes any change in current.

### System Configuration

- **PS-Simulink Conversion Blocks and vice versa:** These blocks are used to convert physical signals to standard Simulink signals and vice versa, allowing the integration of the Simscape environment with standard Simulink blocks.
- **Scope" block:**  Used to display the resulting signal.
  - Used to display the resulting signal `y(t)`, i.e. the voltage at C2.
- **Solver Configuration" block:** Essential for defining the solver characteristics.
  - It is essential to define the characteristics of the solver used for the simulation in Simscape. It ensures that the calculations are accurate and stable.

<p align="center">            
<img src="https://github.com/JoseEmmanuelVG/MechatronicSystemsControl/assets/89156254/5c7b68c3-b6ac-4a24-a8f8-e119e1b7bd97" width="800" height="500">
    <br>
    <strong><em>  
Circuit simulation diagram 
    </em></strong>
</p>


<p align="center">            
<img src="https://github.com/JoseEmmanuelVG/MechatronicSystemsControl/assets/89156254/01d18b05-eacd-40cf-a0a7-146d596c0cb2" width="800" height="300">
    <br>
    <strong><em>  
Plot y(t), corresponding to the voltage on capacitor C2. 
    </em></strong>
</p>



## 2. Obtain the mathematical model (input-output representation).

To simplify and focus on the main part of the circuit, the node just after the current source is considered.

<p align="center">            
<img src="https://github.com/JoseEmmanuelVG/MechatronicSystemsControl/assets/89156254/84e559e5-77f7-46b1-ac70-81c4763ec79f" width="800" height="300">
    <br>
    <strong><em>  
Plot y(t), corresponding to the voltage on capacitor C2. 
    </em></strong>
</p>

### Kirchhoff's Law for Currents (LIK)

$$ u = I_L + i_{RL} $$

```math
- u: source current. 
- I_L: current in the coil. 
- i_{RL}: current in the resistor which is in series with the coil.
```

$$ i_c = C \frac{dy}{dt} = \dot{y} \quad \text{(due to the relationship } V = \frac{1}{C} \int i_c \, dt) $$

```math
- I_c: current in the capacitor.
- C: capacitance of the capacitor (1 F in this case).
- y: voltage across the capacitor.
- y ̇: derivative of y with respect to time.
```

$$ u = y + i_{RL} \rightarrow i_{RL} = u - \dot{y} $$

### Kirchhoff's Law for Voltages (LVK)

V_R + V_L = y

```math
- V_R: voltage drop across the resistor.
- V_L: voltage drop across the coil.
```

$$ Ri_{RL} + L \frac{d}{dt}i_{RL} = y $$

This equation relates the voltage across the resistor and coil to the voltage across the capacitor. Replacing i_{RL} from the above equation we obtain:

$$ u - \dot{y} + \dot{u} - \ddot{y} = y $$

¨y ̈¨ is the second derivative of y with respect to time.

### Mathematical Model

$$ \ddot{y} + \dot{y} + y = \dot{u} + u $$

